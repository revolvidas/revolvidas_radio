<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Radio Player</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="radio-container">
        <h1 class="radio-title">Mi Radio</h1>
        <button id="playbtn" class="play-button">▶ Reproducir</button>
        <!-- LED de estado -->
        <div class="led" id="play-led" aria-hidden="true"></div>
        <audio id="radioplayer" preload="none">
            <source src="https://radio-proxy-iwb2.onrender.com/radio" type="audio/mpeg">
            Tu navegador no soporta la reproducción de audio.
        </audio>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const player = document.getElementById("radioplayer");
            const playbtn = document.getElementById("playbtn");
            const led = document.getElementById("play-led");

            function toggleRadio() {
                if (player.paused) {
                    player.play().then(() => {
                        playbtn.textContent = "⏸ Pausar";
                        led.classList.remove("waiting");
                        led.classList.add("on");
                    }).catch(err => {
                        console.error("Error al reproducir:", err);
                        playbtn.textContent = "▶ Reproducir";
                        led.classList.remove("on", "waiting");
                    });

                    // Mientras carga
                    playbtn.textContent = "Cargando...";
                    led.classList.add("waiting");
                } else {
                    player.pause();
                    playbtn.textContent = "▶ Reproducir";
                    led.classList.remove("on", "waiting");
                }
            }

            playbtn.addEventListener("click", toggleRadio);

            // Eventos para actualizar LED
            player.addEventListener("playing", () => {
                led.classList.remove("waiting");
                led.classList.add("on");
            });

            player.addEventListener("pause", () => {
                led.classList.remove("on", "waiting");
            });

            player.addEventListener("waiting", () => {
                if (!player.paused) {
                    led.classList.remove("on");
                    led.classList.add("waiting");
                }
            });

            player.addEventListener("stalled", () => {
                if (!player.paused) {
                    led.classList.remove("on");
                    led.classList.add("waiting");
                }
            });

            player.addEventListener("error", () => {
                led.classList.remove("on", "waiting");
            });
        });
    </script>
</body>
</html>
